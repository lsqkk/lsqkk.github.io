<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æ¯æ—¥çŸ¥è¯†æŒ‘æˆ˜ - å¤¸å…‹åšå®¢</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f0f8ff;
        }
        .card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .options {
            margin: 15px 0;
        }
        .option-btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
color: black;
        }
        .option-btn:hover {
            background: #e9ecef;
        }
        .selected {
            background: #cfe2ff;
            border-color: #9ec5fe;
        }
        #stats {
            background: #e2e3e5;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        button {
            background: #0d6efd;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:disabled {
            background: #6c757d;
        }
#submitBtn {
    background: #0d6efd;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    display: inline-block; /* è®¾ç½®ä¸ºè¡Œå†…å—å…ƒç´  */
}

#resultMessage {
    display: inline-block; /* è®¾ç½®ä¸ºè¡Œå†…å—å…ƒç´  */
    margin-left: 10px; /* æ·»åŠ å·¦è¾¹è· */
    font-weight: bold; /* åŠ ç²—å­—ä½“ */
    font-size: 16px; /* è®¾ç½®å­—ä½“å¤§å° */
}

.success {
    color: #28a745; /* ç­”å¯¹æ—¶çš„ç»¿è‰² */
}

.error {
    color: #dc3545; /* ç­”é”™æ—¶çš„çº¢è‰² */
}
    </style>
</head>
<body>
    <div class="card">
        <h2>æ¯æ—¥çŸ¥è¯†æŒ‘æˆ˜ - å¤¸å…‹åšå®¢</h2>
        <div id="question"></div>
        <div class="options" id="options"></div>
        <button onclick="submitAnswer()" id="submitBtn" disabled>æäº¤ç­”æ¡ˆ</button>
<div id="resultMessage" class="result-message"></div>
        <div id="stats"></div>
        <div id="message"></div>
    </div>

    <script>
        let currentAnswer = '';
        let selectedOption = null;
        let selectedAnswer = '';

        // åˆå§‹åŒ–ç»Ÿè®¡ä¿¡æ¯
        let stats = {
            total: 0,
            correct: 0,
            date: new Date().toLocaleDateString()
        };

        // ä»localStorageåŠ è½½æ•°æ®
        function loadStats() {
            const saved = localStorage.getItem('quizStats');
            if (saved) {
                const savedStats = JSON.parse(saved);
                if (savedStats.date === new Date().toLocaleDateString()) {
                    stats = savedStats;
                }
            }
        }

        // ä¿å­˜ç»Ÿè®¡ä¿¡æ¯
        function saveStats() {
            stats.date = new Date().toLocaleDateString();
            localStorage.setItem('quizStats', JSON.stringify(stats));
            
            // æ£€æŸ¥æ¯æ—¥æˆå°±
            if (stats.correct >= 10) {
                localStorage.setItem('dailyAchievement', new Date().toLocaleDateString());
            }
        }

// æ˜¾ç¤ºæ­£ç¡®ç­”æ¡ˆåŠå…¶å†…å®¹
// æ˜¾ç¤ºæ­£ç¡®ç­”æ¡ˆåŠå…¶å†…å®¹
function displayCorrectAnswer(correctAnswer) {
    const optionsContainer = document.getElementById('options');
    const correctOption = optionsContainer.querySelector(`button[data-answer="${correctAnswer}"]`);
    if (correctOption) {
        const correctText = correctOption.textContent.trim();
        const msgDiv = document.getElementById('resultMessage');
        msgDiv.innerHTML += ` æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š${correctAnswer} - ${correctText}`; // ä¸æ¢è¡Œï¼Œç›´æ¥è¿½åŠ 
    }
}        // è·å–é¢˜ç›®
        async function getQuestion() {
            try {
                const response = await fetch('https://xiaoapi.cn/API/game_dati.php?id=1828222534&msg=å¼€å§‹æ¸¸æˆ');
                const data = await response.json();
                
                if (data.code === 200) {
                    currentAnswer = data.data.answer;
                    displayQuestion(data.data);
                } else {
                    throw new Error('APIè¿”å›é”™è¯¯');
                }
            } catch (error) {
                console.error('è·å–é¢˜ç›®å¤±è´¥:', error);
                showMessage('è·å–é¢˜ç›®å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                // 5ç§’åé‡è¯•
                setTimeout(getQuestion, 5000);
            }
        }

        // æ˜¾ç¤ºé¢˜ç›®
function displayQuestion(data) {
    document.getElementById('question').innerHTML = `
        <p>${data.msg.replace(/\n/g, '<br>')}</p>
    `;

    const optionsContainer = document.getElementById('options');
    optionsContainer.innerHTML = data.option.split('\n').map(opt => `
        <button class="option-btn" onclick="selectOption(this, '${opt[0]}')" data-answer="${opt[0]}">
            ${opt}
        </button>
    `).join('');

    updateStatsDisplay();
}
        // é€‰æ‹©é€‰é¡¹
        function selectOption(btn, value) {
            if (selectedOption) selectedOption.classList.remove('selected');
            selectedOption = btn;
            selectedAnswer = value;
            selectedOption.classList.add('selected');
            document.getElementById('submitBtn').disabled = false;
        }

        // æäº¤ç­”æ¡ˆ
// æäº¤ç­”æ¡ˆ
// æäº¤ç­”æ¡ˆ
async function submitAnswer() {
    if (!selectedOption) return;

    const isCorrect = selectedAnswer === currentAnswer;
    stats.total++;
    if (isCorrect) {
        stats.correct++;
        playSound('correct'); // ç­”å¯¹æ—¶æ’­æ”¾æ­£ç¡®éŸ³æ•ˆ
        showMessage('ğŸ‰ å›ç­”æ­£ç¡®ï¼', 'success');
    } else {
        playSound('wrong'); // ç­”é”™æ—¶æ’­æ”¾é”™è¯¯éŸ³æ•ˆ
        showMessage('âŒ å›ç­”é”™è¯¯', 'error');
        displayCorrectAnswer(currentAnswer);
    }

    saveStats();

    // æ¸…é™¤å½“å‰é€‰æ‹©
    if (selectedOption) {
        selectedOption.classList.remove('selected');
    }
    selectedOption = null;
    selectedAnswer = '';
    document.getElementById('submitBtn').disabled = true;

    // è·å–ä¸‹ä¸€é¢˜
    await getQuestion();
}

        // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
        function updateStatsDisplay() {
            document.getElementById('stats').innerHTML = `
                ä»Šæ—¥ç­”é¢˜ç»Ÿè®¡ï¼š
                ç­”é¢˜æ•°ï¼š${stats.total}æ¬¡ | 
                æ­£ç¡®ç‡ï¼š${stats.total ? ((stats.correct/stats.total)*100).toFixed(1) : 0}% |
                æ­£ç¡®æ•°ï¼š${stats.correct}
            `;
        }

        // æ˜¾ç¤ºæç¤ºä¿¡æ¯
// æ˜¾ç¤ºæç¤ºä¿¡æ¯
function showMessage(text, type) {
    const msgDiv = document.getElementById('resultMessage');
    msgDiv.textContent = text;
    msgDiv.className = type; // æ ¹æ®ç­”å¯¹æˆ–ç­”é”™è®¾ç½®æ ·å¼
    setTimeout(() => msgDiv.textContent = '', 2000); // 2ç§’åæ¸…é™¤æç¤ºä¿¡æ¯
}

        // åˆå§‹åŒ–
        function init() {
            loadStats();
            getQuestion();
            updateStatsDisplay();
        }
// æ’­æ”¾éŸ³æ•ˆ
function playSound(type) {
    const audio = new Audio();
    if (type === 'correct') {
        audio.src = '3.MP3'; // ç­”å¯¹æ—¶æ’­æ”¾çš„éŸ³é¢‘æ–‡ä»¶
    } else if (type === 'wrong') {
        audio.src = '2.MP3'; // ç­”é”™æ—¶æ’­æ”¾çš„éŸ³é¢‘æ–‡ä»¶
    }
    audio.play();
}
        // é¡µé¢åŠ è½½æ—¶å¯åŠ¨
        init();
    </script>
</body>
</html>
