<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤¸å…‹åšå®¢ OJ - è®¨è®ºåŒº</title>
    <link rel="stylesheet" href="/assets/css/basic.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="discussion.css">

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://unpkg.com/marked@4.0.0/marked.min.js"></script>
    <script src="/assets/js/firebase-config.js"></script>
    <script>
        function handleSearch() {
            const searchInput = document.getElementById('oj-search-input');
            const searchValue = searchInput.value.trim();
            if (searchValue) {
                // è·³è½¬åˆ°å¸¦æœ‰ search å‚æ•°çš„ URL
                window.location.href = `problem-list.html?search=${encodeURIComponent(searchValue)}`;
            } else {
                // å¦‚æœè¾“å…¥ä¸ºç©ºï¼Œåˆ™è·³è½¬åˆ°çº¯å‡€çš„åˆ—è¡¨é¡µ
                window.location.href = `problem-list.html`;
            }
        }
    </script>
</head>

<body>
    <div class="header-placeholder"></div>

    <div class="oj-app-wrapper">
        <aside class="oj-sidebar-panel glass-card">
            <h2 class="oj-sidebar-title">QUARK OJ</h2>
            <nav class="oj-sidebar-nav">
                <ul>
                    <li><a href="index.html" class="oj-nav-link">é¦–é¡µ</a></li>
                    <li><a href="index.html" class="oj-nav-link">åˆ·é¢˜</a></li>
                    <li><a href="problem-list.html" class="oj-nav-link">é¢˜åº“</a></li>
                    <li><a href="discussion.html" class="oj-nav-link active">è®¨è®ºåŒº</a></li>
                    <li><a href="submission-record.html" class="oj-nav-link">æäº¤è®°å½•</a></li>
                </ul>
            </nav>
            <hr class="oj-sidebar-divider">
            <div class="oj-sidebar-controls">
                <div class="oj-search-group">
                    <input type="text" id="oj-search-input" class="oj-search-input" placeholder="æœç´¢é¢˜ç›® ID/åç§°">
                    <button class="oj-search-button" onclick="handleSearch()">ğŸ”</button>
                </div>
            </div>
            <br>
            <div class="oj-sidebar-controls" id="admin-login-area">
                <input type="password" id="adminPassword" class="oj-search-input" placeholder="ç®¡ç†å‘˜å¯†ç ">
                <button class="submit-btn" onclick="adminLogin()">ç™»å½•</button>
            </div>
        </aside>

        <main class="oj-main-content">
            <div id="listView" class="view active">
                <section id="newDiscussionForm" class="new-post-form glass-card">
                    <h3><i class="fas fa-edit"></i> å‘èµ·æ–°è®¨è®º</h3>

                    <div class="form-compact-row row-nickname-avatar">
                        <div class="form-group form-nickname">
                            <label for="nickname">æ‚¨çš„æ˜µç§°</label>
                            <input type="text" id="nickname" placeholder="æ˜µç§°">
                        </div>

                        <div class="form-group form-avatar-controls">
                            <label>å¤´åƒè®¾ç½®</label>
                            <div class="avatar-selection-area">
                                <div class="avatar-preview" id="avatarPreview" style="background-color: #5C6BC0;">A
                                </div>
                                <div class="avatar-toggle">
                                    <button id="color-toggle" class="active">é¢œè‰²</button>
                                    <button id="image-toggle">URL</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="avatar-input-container">
                        <div id="color-selector" class="avatar-selector active">
                            <input type="color" id="colorPicker" value="#5C6BC0">
                        </div>

                        <div id="image-selector" class="avatar-selector">
                            <input type="text" id="avatarUrl"
                                placeholder="è¾“å…¥å›¾ç‰‡ URL (ä¾‹å¦‚: https://example.com/avatar.jpg)">

                        </div>
                    </div>

                    <div class="form-compact-row row-title-id">
                        <div class="form-group problem-id-group">
                            <label for="newDiscussionProblemId">é¢˜ç›® ID</label>
                            <input type="number" id="newDiscussionProblemId" placeholder="å¦‚: 1001" value="1001">
                        </div>
                        <div class="form-group discussion-title-group">
                            <label for="newDiscussionTitle">è®¨è®ºä¸»é¢˜</label>
                            <input type="text" id="newDiscussionTitle" placeholder="è¯·è¾“å…¥ä¸»é¢˜">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="newDiscussionContent">å†…å®¹ (Markdown)</label>
                        <textarea id="newDiscussionContent" rows="4" placeholder="æ”¯æŒ Markdown æ ¼å¼..."></textarea>
                    </div>

                    <div class="form-submit-row">
                        <button class="submit-btn" onclick="submitNewDiscussion()">å‘å¸ƒè®¨è®º</button>
                    </div>
                </section>

                <section class="discussions-list-section">
                    <h2>æ‰€æœ‰è®¨è®ºå¸–</h2>
                    <div class="discussions-container" id="discussionsContainer">
                        <!-- è®¨è®ºå¸–å°†ç”±JavaScriptåŠ¨æ€åŠ è½½ -->
                    </div>

                    <div class="pagination" id="pagination">
                        <!-- åˆ†é¡µå°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </section>
            </div>

            <div id="detailView" class="view" style="display:none;">
                <button class="back-to-list-btn" onclick="showListView()">
                    <i class="fas fa-arrow-left"></i> è¿”å›è®¨è®ºåˆ—è¡¨
                </button>

                <div id="singleDiscussionContent" class="discussion-detail-card">
                    <!-- å•ä¸ªè®¨è®ºè¯¦æƒ…å°†ç”±JavaScriptåŠ¨æ€åŠ è½½ -->
                </div>
            </div>
        </main>
    </div>

    <script src="/assets/js/nav.js"></script>
    <script src="./js/discussion.js"></script>
    <script src="/assets/js/disable-right-click.js"></script>
</body>

</html>