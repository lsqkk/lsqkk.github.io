<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤¸å…‹åšå®¢ OJ - åœ¨çº¿ç»ƒä¹ </title>
    <link rel="stylesheet" href="nav.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="/css/basic.css">
    <!-- Markdown å’Œ LaTeX æ”¯æŒ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <script src="/js/nav.js"></script>
    <script>
        function handleSearch() {
            const searchInput = document.getElementById('oj-search-input');
            const searchValue = searchInput.value.trim();
            if (searchValue) {
                // è·³è½¬åˆ°å¸¦æœ‰ search å‚æ•°çš„ URL
                window.location.href = `problem-list.html?search=${encodeURIComponent(searchValue)}`;
            } else {
                // å¦‚æœè¾“å…¥ä¸ºç©ºï¼Œåˆ™è·³è½¬åˆ°çº¯å‡€çš„åˆ—è¡¨é¡µ
                window.location.href = `problem-list.html`;
            }
        }
    </script>
    <link rel="stylesheet" data-name="vs/editor/editor.main"
        href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/editor/editor.main.min.css">

    <style>
        /* Markdown æ¸²æŸ“æ ·å¼ */
        .markdown-body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            font-size: 16px;
            line-height: 1.6;
            word-wrap: break-word;
            padding: 20px;
        }

        .markdown-body h1,
        .markdown-body h2,
        .markdown-body h3 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            border-bottom: 1px solid #eaecef;
            padding-bottom: 0.3em;
        }

        .markdown-body h1 {
            font-size: 2em;
        }

        .markdown-body h2 {
            font-size: 1.5em;
        }

        .markdown-body h3 {
            font-size: 1.25em;
        }

        .markdown-body p {
            margin-top: 0;
            margin-bottom: 16px;
        }

        .markdown-body pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            padding: 16px;
            overflow: auto;
            margin-bottom: 16px;
        }

        .markdown-body code {
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
            font-size: 85%;
            background-color: rgba(27, 31, 35, 0.05);
            border-radius: 3px;
            padding: 0.2em 0.4em;
        }

        .markdown-body pre code {
            background-color: transparent;
            padding: 0;
        }

        .markdown-body blockquote {
            border-left: 0.25em solid #dfe2e5;
            color: #6a737d;
            padding: 0 1em;
            margin: 0 0 16px 0;
        }

        .markdown-body ul,
        .markdown-body ol {
            padding-left: 2em;
            margin-bottom: 16px;
        }

        .markdown-body table {
            border-collapse: collapse;
            margin-bottom: 16px;
            width: 100%;
        }

        .markdown-body table th,
        .markdown-body table td {
            border: 1px solid #dfe2e5;
            padding: 6px 13px;
        }

        .markdown-body table th {
            font-weight: 600;
            background-color: #f6f8fa;
        }

        .katex-display {
            margin: 1em 0;
            overflow-x: auto;
            overflow-y: hidden;
        }

        /* æ•°å­¦å…¬å¼å®¹å™¨ */
        .math-container {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #2196f3;
        }

        /* å†…è”å…¬å¼æ ·å¼ */
        .katex {
            font-size: 1.1em;
        }
    </style>
</head>

<body>

    <div class="oj-app-wrapper">

        <aside class="oj-sidebar-panel glass-card">
            <h2 class="oj-sidebar-title">å¤¸å…‹ OJ</h2>

            <nav class="oj-sidebar-nav">
                <ul>
                    <li><a href="index.html" class="oj-nav-link active">é¦–é¡µ | é¢˜ç›®</a></li>
                    <li><a href="problem-list.html" class="oj-nav-link">é¢˜åº“</a></li>
                    <li><a href="discussion.html" class="oj-nav-link">è®¨è®ºåŒº</a></li>
                    <li><a href="submission-record.html" class="oj-nav-link">æäº¤è®°å½•</a></li>
                </ul>
            </nav>

            <hr class="oj-sidebar-divider">
            <div class="oj-sidebar-controls">
                <div class="oj-search-group">
                    <input type="text" id="oj-search-input" class="oj-search-input" placeholder="æœç´¢é¢˜ç›® ID/åç§°">
                    <button class="oj-search-button" onclick="handleSearch()">ğŸ”</button>
                </div>
            </div>
        </aside>

        <main class="oj-main-content">
            <section class="oj-problem-panel glass-card">
                <h2 class="oj-problem-title" id="problem-title">åŠ è½½ä¸­...</h2>
                <div class="oj-problem-info">
                    <span class="oj-time-limit">æ—¶é—´é™åˆ¶: <strong id="time-limit">1000ms</strong></span>
                    <span class="oj-memory-limit">å†…å­˜é™åˆ¶: <strong id="memory-limit">64MB</strong></span>
                </div>
                <div class="oj-description-section">
                    <h3>é¢˜ç›®æè¿°</h3>
                    <div id="problem-description" class="markdown-body"></div>
                </div>
                <div class="oj-description-section">
                    <h3>è¾“å…¥æ ¼å¼</h3>
                    <div id="problem-input-format" class="markdown-body"></div>
                </div>
                <div class="oj-description-section">
                    <h3>è¾“å‡ºæ ¼å¼</h3>
                    <div id="problem-output-format" class="markdown-body"></div>
                </div>
                <div class="oj-description-section">
                    <h3>è¾“å…¥/è¾“å‡ºç¤ºä¾‹</h3>
                    <div class="oj-sample-io">
                        <div class="oj-sample-block">
                            <h4>è¾“å…¥ç¤ºä¾‹</h4>
                            <pre id="sample-input"></pre>
                        </div>
                        <div class="oj-sample-block">
                            <h4>è¾“å‡ºç¤ºä¾‹</h4>
                            <pre id="sample-output"></pre>
                        </div>
                    </div>
                </div>
            </section>

            <section class="oj-editor-panel glass-card">
                <div class="oj-editor-tools">
                    <label for="language-select" class="oj-control-label">æäº¤è¯­è¨€:</label>
                    <select id="language-select" class="oj-code-language-select">
                        <option value="71">Python 3 (ID: 71)</option>
                        <option value="54" selected>C++ (GCC 9.2.0) (ID: 54)</option>
                        <option value="62">Java (OpenJDK 13.0.1) (ID: 62)</option>
                    </select>
                    <button id="submit-button" class="oj-submit-button">æäº¤ä»£ç </button>
                </div>

                <div id="editor-container" class="oj-editor-container"></div>

                <div id="result-panel" class="oj-result-panel" style="display: none;">
                    <h3>åˆ¤é¢˜ç»“æœ</h3>
                    <p>çŠ¶æ€: <strong id="result-status">ç­‰å¾…æäº¤...</strong></p>
                    <p>è¿è¡Œæ—¶é—´: <span id="result-time">--</span></p>
                    <p>å†…å­˜å ç”¨: <span id="result-memory">--</span></p>
                    <pre id="result-output" class="oj-result-output"></pre>
                    <pre id="result-error" class="oj-result-error"></pre>
                </div>
            </section>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/loader.min.js"></script>
    <script>
        // é…ç½® marked ä»¥æ­£ç¡®å¤„ç† LaTeX
        marked.setOptions({
            highlight: function (code, lang) {
                // ä»£ç é«˜äº®å¤„ç†
                return code;
            },
            breaks: true,
            gfm: true,
            pedantic: false,
            smartypants: true
        });

        // åˆ›å»ºä¸€ä¸ªç®€å•çš„ Markdown è½¬ HTML å‡½æ•°
        function renderMarkdown(markdown) {
            if (!markdown) return '';

            // ç›´æ¥ä½¿ç”¨ marked è½¬æ¢ Markdown
            return marked.parse(markdown);
        }

        require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs' } });
        let editor;

        require(['vs/editor/editor.main'], function () {
            // Monaco Editor åˆå§‹åŒ–
            editor = monaco.editor.create(document.getElementById('editor-container'), {
                value: [
                    '//your code here'
                ].join('\n'),
                language: 'cpp',
                theme: 'vs-dark',
                automaticLayout: true,
            });

            document.getElementById('language-select').addEventListener('change', (e) => {
                const langId = e.target.value;
                let monacoLang = 'cpp';
                if (langId == '71') monacoLang = 'python';
                if (langId == '62') monacoLang = 'java';
                if (langId == '54') monacoLang = 'cpp';

                monaco.editor.setModelLanguage(editor.getModel(), monacoLang);
            });

            // åŠ¨æ€åŠ è½½ utils.js å’Œ problem.jsï¼Œå¹¶æ‰§è¡Œåˆå§‹åŒ–
            const scriptUtils = document.createElement('script');
            scriptUtils.src = './js/utils.js';
            document.body.appendChild(scriptUtils);

            // ç¡®ä¿ utils.js åŠ è½½åï¼Œå†åŠ è½½ problem.js
            scriptUtils.onload = function () {
                const scriptProblem = document.createElement('script');
                scriptProblem.src = './js/problem.js';
                document.body.appendChild(scriptProblem);

                // problem.js åŠ è½½å®Œæˆåï¼Œè°ƒç”¨å…¶åˆå§‹åŒ–å‡½æ•°
                scriptProblem.onload = function () {
                    if (typeof initializeProblemPage !== 'undefined') {
                        initializeProblemPage();
                    }
                }
            };
        });
    </script>
</body>

</html>