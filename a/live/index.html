<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://download.agora.io/sdk/release/AgoraRTC_N-4.20.2.js"></script>
    <script src="https://unpkg.com/marked@4.0.0/marked.min.js"></script>
    <title>直播 - 夸克博客直播间</title>
    <link rel="stylesheet" href="css/index.css">
</head>

<body>
    <div class="container">
        <div class="header">
            <div class="stream-info">
                <div class="stream-title">
                    <i class="fas fa-video"></i>
                    <span id="stream-title">直播房间</span>
                </div>
                <div class="stream-description" id="stream-description">欢迎来到直播间！</div>
            </div>
            <div class="stream-status">
                <div class="status-badge" id="status">等待连接...</div>
                <div class="audio-status" id="audio-status">
                    <i class="fas fa-volume-mute"></i>
                    <span>音频等待中</span>
                </div>
            </div>
        </div>

        <div id="error-message" class="error" style="display: none;"></div>

        <div class="live-container">
            <div class="video-container">
                <div id="video-placeholder" class="video-placeholder">
                    <i class="fas fa-satellite-dish"></i>
                    <div>准备播放直播流...</div>
                </div>
                <video id="live-video" style="display: none;" controls autoplay muted playsinline></video>
            </div>

            <div class="chat-container">
                <div class="chat-header">
                    <h3><i class="fas fa-comments"></i> 实时聊天</h3>
                    <div class="message-count">消息: <span id="message-count">0</span></div>
                </div>
                <div class="messages" id="messages">
                    <div class="message">
                        <div class="message-header">
                            <div class="message-avatar" style="background: #4a6cf7">系</div>
                            <span class="user">系统</span>
                            <span class="time" id="current-time"></span>
                        </div>
                        <div class="message-content">欢迎来到直播房间！直播开始后这里会显示实时聊天</div>
                    </div>
                </div>

                <div class="message-input-container">
                    <div class="user-avatar-input">
                        <div class="avatar-preview" id="avatar-preview" style="background: #4a6cf7">A</div>
                        <div class="avatar-options" id="avatar-options">
                            <div class="avatar-toggle">
                                <button class="toggle-btn active" id="color-toggle">颜色</button>
                                <button class="toggle-btn" id="image-toggle">图片URL</button>
                            </div>
                            <div class="color-picker" id="color-picker">
                                <div class="color-option selected" style="background: #4a6cf7"></div>
                                <div class="color-option" style="background: #f56565"></div>
                                <div class="color-option" style="background: #48bb78"></div>
                                <div class="color-option" style="background: #ed8936"></div>
                                <div class="color-option" style="background: #9f7aea"></div>
                            </div>
                            <input type="text" id="avatar-url" placeholder="图片URL (jpg, png, webp)"
                                style="display: none;">
                            <input type="text" id="nickname" placeholder="昵称" value="观众">
                        </div>
                    </div>
                    <input type="text" id="message-input" placeholder="输入消息...">
                    <button id="send-btn">发送</button>
                </div>
                <div class="markdown-toggle">
                    <input type="checkbox" id="use-markdown" checked>
                    <label for="use-markdown">使用Markdown格式</label>
                </div>
                <div class="action-buttons">
                    <button id="like-btn" class="action-btn">
                        <i class="fas fa-heart"></i>
                        <span>点赞</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="stats-container">
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="viewer-count">0</div>
                    <div class="stat-label">在线观众</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="like-count">0</div>
                    <div class="stat-label">总点赞数</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="message-count-stat">0</div>
                    <div class="stat-label">消息数量</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="stream-duration">00:00</div>
                    <div class="stat-label">直播时长</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="control-btn" onclick="toggleFullscreen()">
                <i class="fas fa-expand"></i>
                全屏切换
            </button>
            <button class="control-btn" onclick="testAudio()">
                <i class="fas fa-volume-up"></i>
                测试音频
            </button>
            <button class="control-btn" onclick="toggleMute()">
                <i class="fas fa-volume-mute"></i>
                静音切换
            </button>
            <button class="control-btn" onclick="copyInviteLink()">
                <i class="fas fa-share"></i>
                复制邀请链接
            </button>
            <button class="control-btn" onclick="toggleManualPanel()">
                <i class="fas fa-cog"></i>
                手动连接
            </button>
            <button class="control-btn" onclick="reconnect()">
                <i class="fas fa-redo"></i>
                重新连接
            </button>
        </div>

        <div class="manual-panel" id="manual-panel">
            <h3><i class="fas fa-tools"></i> 手动连接</h3>
            <div class="form-group">
                <label for="manual-token">Token</label>
                <textarea id="manual-token" placeholder="请输入Token" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="manual-channel">频道名称</label>
                <input type="text" id="manual-channel" placeholder="请输入频道名称" value="lsqkk_live_channel">
            </div>
            <button class="control-btn" onclick="connectManually()">
                <i class="fas fa-plug"></i>
                连接
            </button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <!-- HLS.js for video streaming -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

    <script src="js/index.js"></script>
</body>

</html>